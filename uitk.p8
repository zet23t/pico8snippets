pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
#include scripts/uitk.lua
#include scripts/util.lua

function _init()
	ui_tk_enable_mouse()
	
	-- the root element for everything
	ui_root = ui_rect_new(16,16,96,96)
	-- adding a rect fill component for the background
	ui_root:add_component(rectfill_component_new(5,4))

	-- a colored rectangle that reacts on mouse enter / exit
	local btn = ui_rect_new(8,8,32,10,ui_root)
	local fill = rectfill_component_new(3,4)
	function fill:mouse_enter()
		self.fill = 4
	end
	function fill:mouse_exit()
		self.fill = 3
	end
	btn:add_component(fill)

	-- a button tht looks like a classic button
	local btn = ui_rect_new(42,8,32,9,ui_root)
	-- a scale 9 for the background
	local s9 = sprite9_component_new(16,0,8,8,2,2,2,2)
	function s9:mouse_enter()
		self.sx = 32
	end
	function s9:mouse_exit()
		self.sx = 16
	end
	function s9:is_pressed_down()
		self.sx = 24
	end
	function s9:was_released(rect)
		self.sx = rect.flags.is_mouse_over and 32 or 16
	end
	btn:add_component(s9)

	-- a text component for the caption
	local t = text_component_new("tick",1)
	function t:was_triggered()
		self.text = self.text == "tick" and "tock!" or "tick"
	end
	btn:add_component(t)

	-- a dragable button element
	local btn = ui_rect_new(42,20,44,12,ui_root)
	local s9 = sprite9_component_new(16,0,8,8,2,2,2,2)
	function s9:mouse_enter()
		self.sx = 32
	end
	function s9:mouse_exit()
		self.sx = 16
	end
	function s9:is_pressed_down(ui_rect, mx, my)
		self.sx = 24
		ui_rect.x = mx - self.mx + ui_rect.x
		ui_rect.y = my - self.my + ui_rect.y
	end
	function s9:was_pressed_down(ui_rect, mx, my)
		self.mx, self.my = mx,my
	end
	function s9:was_released(rect)
		self.sx = rect.flags.is_mouse_over and 32 or 16
	end
	-- adding the scale 9, text and sprite component
	btn:add_component(s9)
	btn:add_component(text_component_new("drag me",1,0,0,0,8))
	btn:add_component(sprite_component_new(5,2,2))
end

function _update()
	ui_tk_update(ui_root)
end

function _draw()
	cls()
	ui_tk_draw(ui_root)
end
__gfx__
00000000110000007777777d1111111d7777777d0111000011111111111001110000000000000000000000000000000000000000000000000000000000000000
0000000017100000766666611ffffff77ffffff1199911001c6666c1188118810000000000000000000000000000000000000000000000000000000000000000
0070070016710000766666611ffffff77ffffff1199999101c6666c1018888100000000000000000000000000000000000000000000000000000000000000000
0007700016671000766666611ffffff77ffffff1192222211cccccc1001881000000000000000000000000000000000000000000000000000000000000000000
0007700016667100766666611ffffff77ffffff1192444211c7777c1018888100000000000000000000000000000000000000000000000000000000000000000
0070070016511100766666611ffffff77ffffff1124442101c7777c1188118810000000000000000000000000000000000000000000000000000000000000000
0000000011161000766666611ffffff77ffffff1122222101ccccc10111001110000000000000000000000000000000000000000000000000000000000000000
0000000000111000d1111111d7777777d11111110111110011111100000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
